---
import Layout from '../layouts/Layout.astro'
import { weeks, stages } from '../data/weeks'

const stageColorBorder = {
  observer: 'border-sage',
  practitioner: 'border-terracotta',
  critic: 'border-dusty-rose',
  creator: 'border-rust',
}
const stageColorBg = {
  observer: 'bg-sage-light',
  practitioner: 'bg-cream/30',
  critic: 'bg-dusty-rose-light',
  creator: 'bg-paper-dark',
}
const stageColorText = {
  observer: 'text-sage',
  practitioner: 'text-terracotta',
  critic: 'text-dusty-rose',
  creator: 'text-rust',
}
---

<Layout title="学习路径 — VibeCoder Learn">
  <section class="py-4 sm:py-8">
    <p class="font-mono text-sm text-rust mb-2 tracking-wide">LEARNING PATH</p>
    <h1 class="text-2xl sm:text-3xl font-bold text-charcoal mb-2">12周学习路径</h1>
    <p class="text-charcoal-light mb-8">每周 5-8 小时 · 从观察者到创造者</p>

    {stages.map(stage => {
      const stageWeeks = weeks.filter(w => w.stage === stage.id)
      const sid = stage.id as keyof typeof stageColorBorder
      return (
        <div class="mb-10">
          {/* Stage header */}
          <div class={`flex items-center gap-3 mb-5 pb-3 border-b-2 ${stageColorBorder[sid]}`}>
            <span class="text-2xl">{stage.icon}</span>
            <div>
              <h2 class="text-xl font-bold text-charcoal">{stage.label}</h2>
              <p class="text-sm text-warm-gray">第{stage.weeks}周 · {stage.description}</p>
            </div>
          </div>

          {/* Weeks */}
          <div class="space-y-4 ml-2 sm:ml-4">
            {stageWeeks.map(week => (
              <div class={`rounded-lg p-5 border border-light-beige ${stageColorBg[sid]} hover:shadow-[2px_2px_0_rgba(41,41,41,0.06)] transition-all`}>
                <div class="flex items-start justify-between mb-3">
                  <div>
                    <span class={`font-mono text-xs font-bold ${stageColorText[sid]}`}>WEEK {week.number}</span>
                    <h3 class="text-lg font-bold text-charcoal">{week.title}</h3>
                  </div>
                </div>
                <p class="text-sm text-charcoal-light mb-4">{week.goal}</p>

                {/* Project */}
                <div class="mb-3">
                  <p class="text-xs font-mono text-warm-gray mb-1">项目</p>
                  <p class="text-sm font-medium text-charcoal">{week.project}</p>
                </div>

                {/* Challenges */}
                <div class="mb-3">
                  <p class="text-xs font-mono text-warm-gray mb-2">品味挑战</p>
                  <div class="flex flex-wrap gap-1.5">
                    {week.challenges.map(ch => {
                      const id = ch.split(' ')[0]
                      return (
                        <span class="inline-flex items-center px-2 py-0.5 bg-paper rounded text-xs font-mono border border-light-beige">
                          <span class="text-rust font-bold mr-1">{id}</span>
                          <span class="text-charcoal-light">{ch.slice(id.length + 1)}</span>
                        </span>
                      )
                    })}
                  </div>
                </div>

                {/* Milestones */}
                <div>
                  <p class="text-xs font-mono text-warm-gray mb-2">里程碑</p>
                  <ul class="space-y-1">
                    {week.milestones.map(m => (
                      <li class="flex items-start gap-2 text-sm text-charcoal-light">
                        <span class="text-light-beige mt-0.5">□</span>
                        <span>{m}</span>
                      </li>
                    ))}
                  </ul>
                </div>
              </div>
            ))}
          </div>
        </div>
      )
    })}
  </section>
</Layout>
