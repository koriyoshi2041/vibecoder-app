---
import Layout from '../../layouts/Layout.astro'
import PathWeek from '../../components/PathWeek'
import { weeks, stages } from '../../data/weeks.en'
import { t } from '../../i18n'

const locale = 'en' as const

const stageColorBorder = {
  observer: 'border-sage',
  practitioner: 'border-terracotta',
  critic: 'border-dusty-rose',
  creator: 'border-rust',
}
const stageColorBg = {
  observer: 'bg-sage-light',
  practitioner: 'bg-cream/30',
  critic: 'bg-dusty-rose-light',
  creator: 'bg-paper-dark',
}
const stageColorText = {
  observer: 'text-sage',
  practitioner: 'text-terracotta',
  critic: 'text-dusty-rose',
  creator: 'text-rust',
}
---

<Layout title="Learning Path — VibeCoder Learn" locale={locale}>
  <section class="py-4 sm:py-8">
    <p class="font-mono text-sm text-rust mb-2 tracking-wide">{t('path.label', locale)}</p>
    <h1 class="text-2xl sm:text-3xl font-bold text-charcoal mb-2">{t('path.title', locale)}</h1>
    <p class="text-charcoal-light mb-8">{t('path.subtitle', locale)}</p>

    {stages.map(stage => {
      const stageWeeks = weeks.filter(w => w.stage === stage.id)
      const sid = stage.id as keyof typeof stageColorBorder
      return (
        <div class="mb-10">
          {/* Stage header */}
          <div class={`flex items-center gap-3 mb-5 pb-3 border-b-2 ${stageColorBorder[sid]}`}>
            <span class="text-2xl">{stage.icon}</span>
            <div>
              <h2 class="text-xl font-bold text-charcoal">{stage.label}</h2>
              <p class="text-sm text-warm-gray">{t('path.weekPrefix', locale)}{stage.weeks}{t('path.weekSuffix', locale)} · {stage.description}</p>
            </div>
          </div>

          {/* Weeks - now interactive */}
          <div class="space-y-4 ml-2 sm:ml-4">
            {stageWeeks.map(week => (
              <PathWeek
                client:load
                week={week}
                stageColorBg={stageColorBg[sid]}
                stageColorText={stageColorText[sid]}
                locale="en"
              />
            ))}
          </div>
        </div>
      )
    })}
  </section>
</Layout>
