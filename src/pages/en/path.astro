---
import Layout from '../../layouts/Layout.astro'
import PathWeek from '../../components/PathWeek'
import { weeks, stages } from '../../data/weeks.en'
import { t } from '../../i18n'

const locale = 'en' as const

const stageColorBorder = {
  observer: 'border-sage',
  practitioner: 'border-terracotta',
  critic: 'border-dusty-rose',
  creator: 'border-rust',
}
const stageColorBg = {
  observer: 'bg-sage-light',
  practitioner: 'bg-cream/30',
  critic: 'bg-dusty-rose-light',
  creator: 'bg-paper-dark',
}
const stageColorText = {
  observer: 'text-sage',
  practitioner: 'text-terracotta',
  critic: 'text-dusty-rose',
  creator: 'text-rust',
}
const stageIconSvg: Record<string, string> = {
  eye: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"/><circle cx="12" cy="12" r="3"/></svg>',
  wrench: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg>',
  search: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>',
  sparkles: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z"/><path d="M20 3v4"/><path d="M22 5h-4"/><path d="M4 17v2"/><path d="M5 18H3"/></svg>',
}
---

<Layout title="Learning Path — VibeCoder Learn" locale={locale}>
  <section class="py-4 sm:py-8">
    <p class="font-mono text-sm text-rust mb-2 tracking-wide">{t('path.label', locale)}</p>
    <h1 class="text-2xl sm:text-3xl font-bold text-charcoal mb-2">{t('path.title', locale)}</h1>
    <p class="text-charcoal-light mb-8">{t('path.subtitle', locale)}</p>

    {stages.map(stage => {
      const stageWeeks = weeks.filter(w => w.stage === stage.id)
      const sid = stage.id as keyof typeof stageColorBorder
      return (
        <div class="mb-10">
          {/* Stage header */}
          <div class={`flex items-center gap-3 mb-5 pb-3 border-b-2 ${stageColorBorder[sid]}`}>
            <span class={`${stageColorText[sid]}`} set:html={stageIconSvg[stage.icon] || ''} />
            <div>
              <h2 class="text-xl font-bold text-charcoal">{stage.label}</h2>
              <p class="text-sm text-warm-gray">{t('path.weekPrefix', locale)}{stage.weeks}{t('path.weekSuffix', locale)} · {stage.description}</p>
            </div>
          </div>

          {/* Weeks - now interactive */}
          <div class="space-y-4 ml-2 sm:ml-4">
            {stageWeeks.map(week => (
              <PathWeek
                client:load
                week={week}
                stageColorBg={stageColorBg[sid]}
                stageColorText={stageColorText[sid]}
                locale="en"
              />
            ))}
          </div>
        </div>
      )
    })}
  </section>
</Layout>
